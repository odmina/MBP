---
title: "Scatter plot (wykres punktowy)"
date: "12/23/2021"
output: html_document
---

```{r}
#załaduj tidyverse
library(tidyverse)
#załaduj zbiór
dane_do_analizy <- read_csv("dane_do_analizy.csv")
```

Chciałabym przedstawić na wykresie zależność między wynikiem w mojej skali, a wiekiem badanych. W związku z tym najpierw policzę wynik w skali, potem "wyczyszczę" zmienną z wiekiem, a następnie stworzę wykres.

# Liczenie wyniku w skali

Metoda zakładająca mało pisania - jeżeli ktoś jest ciekawy, jak działa, niech zajrzy do notatnika o sumowaniu wyników w kwestionariuszu.

```{r}
dane_do_analizy <- dane_do_analizy %>%
mutate(consp_score = reduce(select(., starts_with("Q")), `+`))
```

# Czyszczenie zmiennej wiek

Wiek znajduje się w zmiennej o nazwie age. Sprawdzę, jakie są jej minimum i maksimum.  

```{r}
summary(dane_do_analizy$age)
```

33769 to trochę dużo :) Takie obserwacje niestety trzeba uznać za brak danych. Zobaczmy najpierw, ile jest osób, których wiek jest większy, niż 100 lat. Wybierzmy ze zbioru te obserwacje i zobaczmy, co kryje się w zmiennej "wiek". Skorzystajmy z funkcji `filter()` by wybrać tylko "podejrzane" obserwacje i funkcji `select()` by podejrzeć tylko zmienną wiek (funkcja `select()` wybiera zmienną ze zbioru). Nic nie zapisujemy, tylko oglądmy

```{r}
dane_do_analizy %>%
  filter(age > 100) %>%
  select(age)

```
Mam tylko dwie "trefne" obserwacje. Bez problemu mogę je pominąć w dalszych analizach (uwaga: w raporcie z badania musicie napisać, ile obserwacji pominęliście i dlaczego). Zapisuję odfiltrowany zbiór jako nowy obiekt na wypadek, gdybym chciała wykonać inną analizę na innym zbiorze obserwacji. Chcę pozostawić obserwacje, dla których wiek jest mniejszy bądź równy 100.

```{r}
dane_korelacja <- dane_do_analizy %>%
  filter(age <= 100)
```

# Wykres punktowy

Wykres punktowy tworzy się, korzystając z funkcji `geom_point()`. W deklaracji wykresu podaliście, że korzystacie ze zbioru `dane_korelacja`, w funkcji `geom_point()` wskazaliście zmienne, jakie znajdą się na osi x (pierwszy argument funkcji `aes()`) i y (drugi argument).

```{r}
ggplot(data = dane_korelacja) +
  geom_point(mapping = aes(age, consp_score))
```

Nie wygląda to najpiękniej :) Możecie wprowadzić lekki jitter (nie wiem, jak to się nazywa po polsku...), żeby punkty, które wypadają na wykresie w tym samym miejscu były w niewielkim stopniu przesunięte względem siebie (będzie wtedy widać, gdzie jest ich więcej, a gdzie mniej). Pomocna może być też przezroczystość (alpha) - jeżeli punkty będą częściowo przejrzyste, jeszcze lepiej będzie widać, gdzie jest ich więcej, a gdzie mniej.

```{r}
ggplot(data = dane_korelacja) +
  geom_jitter(mapping = aes(age, consp_score), alpha = 0.7)
```

Nie potrzeba wiele, żeby stwierdzić, że korelacja jest zerowa :) Możecie ją policzyć funkcją `cor()`

```{r}
cor(dane_korelacja$consp_score, dane_korelacja$age)
```

Jeżeli nie byłaby zerowa, warto byłoby dodać jeszcze linię obrazującą zależność między wiekiem a wynikiem.

```{r}
ggplot(data = dane_korelacja) +
  geom_jitter(mapping = aes(age, consp_score), alpha = 0.7) +
  geom_smooth(mapping = aes(age, consp_score))
```

